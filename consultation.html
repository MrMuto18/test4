<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø³ØªØ´Ø§Ø±Ø© ÙÙ„Ø§Ø­ÙŠØ© - ÙÙ„Ø§Ø­ÙŠÙ†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-green: #2d8659;
            --light-green: #4caf50;
            --dark-green: #1e6b45;
            --accent-orange: #f49d37;
            --warm-beige: #f5f1e8;
            --text-dark: #2c3e50;
            --text-light: #6c757d;
            --light-gray: #ecf0f1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', 'Segoe UI', sans-serif;
            background: #f8f6f3;
            min-height: 100vh;
            padding: 0;
            direction: rtl;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .header h1 {
            color: var(--primary-green);
            font-size: 2em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            color: var(--text-light);
            font-size: 1em;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: white;
            color: var(--primary-green);
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s;
            font-size: 0.95em;
        }

        .back-btn:hover {
            background: #f8f9fa;
            border-color: var(--primary-green);
        }

        .progress-container {
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e8e8e8;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-green), var(--light-green));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-text {
            text-align: center;
            color: var(--text-dark);
            font-weight: 600;
            font-size: 0.95em;
        }

        .question-card {
            background: white;
            padding: 40px 35px;
            border-radius: 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            display: none;
        }

        .question-card.active {
            display: block;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 35px;
            font-size: 1.4em;
            color: var(--text-dark);
            font-weight: 600;
        }

        .question-icon {
            font-size: 1.8em;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-card {
            background: #f8f9fa;
            padding: 25px 20px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e9ecef;
        }

        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--primary-green);
        }

        .option-card.selected {
            background: var(--primary-green) !important;
            color: white !important;
            border-color: var(--dark-green) !important;
            transform: scale(1.05) !important;
            box-shadow: 0 8px 20px rgba(45, 134, 89, 0.4) !important;
        }
        
        .option-card.selected .option-label {
            color: white !important;
        }

        .option-icon {
            font-size: 2.5em;
            display: block;
            margin-bottom: 10px;
        }

        .option-label {
            font-weight: bold;
            font-size: 1.1em;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .btn {
            flex: 1;
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-next {
            background: var(--primary-green);
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            background: var(--dark-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(45, 134, 89, 0.3);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-prev {
            background: #f8f9fa;
            color: var(--text-dark);
            border: 1px solid #e0e0e0;
        }

        .btn-prev:hover {
            background: #e9ecef;
        }

        /* Modal Ù„Ù„Ø­Ù„ÙˆÙ„ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .modal.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            max-width: 900px;
            margin: 40px auto;
            border-radius: 20px;
            padding: 40px;
            position: relative;
            animation: slideDown 0.4s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #dc3545;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-close:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-header h2 {
            color: var(--primary-green);
            font-size: 2em;
            margin-bottom: 10px;
        }

        .solution-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-right: 5px solid var(--primary-green);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .solution-box h4 {
            color: var(--primary-green);
            margin-bottom: 10px;
        }

        .pack-section {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .pack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .pack-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .pack-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-btn">
            <i class="fas fa-arrow-right"></i>
            Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>

        <div class="header">
            <h1>
                <span style="font-size: 1.2em;">ğŸ¤–</span>
                Ø§Ø³ØªØ´Ø§Ø±Ø© ÙÙ„Ø§Ø­ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©
            </h1>
            <p>Ø¬Ø§ÙˆØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø­Ù„ÙˆÙ„ Ù…Ø®ØµØµØ© Ù„Ù…Ø­ØµÙˆÙ„Ùƒ</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Ø³Ø¤Ø§Ù„ 1 Ù…Ù† 6</div>
        </div>

        <form id="consultationForm">
            <!-- Ø³Ø¤Ø§Ù„ 1: Ø§Ù„Ù…Ø­ØµÙˆÙ„ -->
            <div class="question-card active" data-question="1">
                <div class="question-title">
                    <span class="question-icon">ğŸŒ±</span>
                    <span>Ø´Ù†ÙŠØ© Ø§Ù„Ù…Ø­ØµÙˆÙ„ Ù…ØªØ§Ø¹ÙƒØŸ</span>
                </div>
                <div class="options-grid">
                    <div class="option-card" data-crop="tomato">
                        <span class="option-icon">ğŸ…</span>
                        <div class="option-label">Ø·Ù…Ø§Ø·Ù…</div>
                    </div>
                    <div class="option-card" data-crop="pepper">
                        <span class="option-icon">ğŸŒ¶ï¸</span>
                        <div class="option-label">ÙÙ„ÙÙ„</div>
                    </div>
                    <div class="option-card" data-crop="grape">
                        <span class="option-icon">ğŸ‡</span>
                        <div class="option-label">Ø¹Ù†Ø¨</div>
                    </div>
                    <div class="option-card" data-crop="fennel">
                        <span class="option-icon">ğŸŒ¿</span>
                        <div class="option-label">Ø¨Ø³Ø¨Ø§Ø³</div>
                    </div>
                    <div class="option-card" data-crop="potato">
                        <span class="option-icon">ğŸ¥”</span>
                        <div class="option-label">Ø¨Ø·Ø§Ø·Ø§</div>
                    </div>
                    <div class="option-card" data-crop="watermelon">
                        <span class="option-icon">ğŸˆ</span>
                        <div class="option-label">Ø¨Ø·ÙŠØ®</div>
                    </div>
                    <div class="option-card" data-crop="melon">
                        <span class="option-icon">ğŸ‰</span>
                        <div class="option-label">Ø¯Ù„Ø§Ø¹</div>
                    </div>
                    <div class="option-card" data-crop="strawberry">
                        <span class="option-icon">ğŸ“</span>
                        <div class="option-label">ÙØ±Ø§ÙˆÙ„Ø©</div>
                    </div>
                    <div class="option-card" data-crop="almond">
                        <span class="option-icon">ğŸŒ°</span>
                        <div class="option-label">Ù„ÙˆØ²ÙŠØ§Øª</div>
                    </div>
                    <div class="option-card" data-crop="grains">
                        <span class="option-icon">ğŸŒ¾</span>
                        <div class="option-label">Ø­Ø¨ÙˆØ¨</div>
                    </div>
                    <div class="option-card" data-crop="olive">
                        <span class="option-icon">ğŸ«’</span>
                        <div class="option-label">Ø²ÙŠØªÙˆÙ†</div>
                    </div>
                    <div class="option-card" data-crop="citrus">
                        <span class="option-icon">ğŸŠ</span>
                        <div class="option-label">Ù‚ÙˆØ§Ø±Øµ</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()" style="visibility: hidden; max-width: 200px;">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>
            </div>

            <!-- Ø³Ø¤Ø§Ù„ 2: Ø§Ù„Ù…Ø³Ø§Ø­Ø© -->
            <div class="question-card" data-question="2">
                <div class="question-title">
                    <span class="question-icon">ğŸ“</span>
                    <span>Ù‚Ø¯Ø§Ø´ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ù…ØªØ§Ø¹ÙƒØŸ</span>
                </div>
                <div class="options-grid">
                    <div class="option-card" data-area="small">
                        <span class="option-icon">ğŸ¡</span>
                        <div class="option-label">Ø£Ù‚Ù„ Ù…Ù† 1 Ù‡ÙƒØªØ§Ø±</div>
                    </div>
                    <div class="option-card" data-area="medium">
                        <span class="option-icon">ğŸŒ¾</span>
                        <div class="option-label">Ù…Ù† 1 Ø¥Ù„Ù‰ 3 Ù‡ÙƒØªØ§Ø±</div>
                    </div>
                    <div class="option-card" data-area="large">
                        <span class="option-icon">ğŸšœ</span>
                        <div class="option-label">Ø£ÙƒØ«Ø± Ù…Ù† 3 Ù‡ÙƒØªØ§Ø±</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()" >Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>
            </div>

            <!-- Ø³Ø¤Ø§Ù„ 3: Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ -->
            <div class="question-card" data-question="3">
                <div class="question-title">
                    <span class="question-icon">ğŸ’§</span>
                    <span>Ø´Ù†ÙˆØ© Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ Ø§Ù„Ù„ÙŠ ØªØ³ØªØ¹Ù…Ù„ÙˆØŸ</span>
                </div>
                <div class="options-grid">
                    <div class="option-card" data-water="drip">
                        <span class="option-icon">ğŸ’§</span>
                        <div class="option-label">ØªÙ†Ù‚ÙŠØ·</div>
                    </div>
                    <div class="option-card" data-water="sprinkler">
                        <span class="option-icon">ğŸš¿</span>
                        <div class="option-label">Ø±Ø´</div>
                    </div>
                    <div class="option-card" data-water="flood">
                        <span class="option-icon">ğŸŒŠ</span>
                        <div class="option-label">ØºÙ…Ø±</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    
                </div>
            </div>

            <!-- Ø³Ø¤Ø§Ù„ 4: Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø© -->
            <div class="question-card" data-question="4">
                <div class="question-title">
                    <span class="question-icon">ğŸŒ</span>
                    <span>Ø´Ù†ÙˆØ© Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©ØŸ</span>
                </div>
                <div class="options-grid">
                    <div class="option-card" data-soil="sandy">
                        <span class="option-icon">ğŸ–ï¸</span>
                        <div class="option-label">Ø±Ù…Ù„ÙŠØ©</div>
                    </div>
                    <div class="option-card" data-soil="clay">
                        <span class="option-icon">ğŸ§±</span>
                        <div class="option-label">Ø·ÙŠÙ†ÙŠØ©</div>
                    </div>
                    <div class="option-card" data-soil="loam">
                        <span class="option-icon">ğŸŒ±</span>
                        <div class="option-label">Ù…Ø®ØªÙ„Ø·Ø©</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    
                </div>
            </div>

            <!-- Ø³Ø¤Ø§Ù„ 5: Ø§Ù„ÙØªØ±Ø©/Ø§Ù„Ù…Ø±Ø­Ù„Ø© -->
            <div class="question-card" data-question="5">
                <div class="question-title">
                    <span class="question-icon">ğŸŒ³</span>
                    <span id="periodQuestion">ÙÙŠ Ø£ÙŠ ÙØªØ±Ø© Ù…Ù† Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ù†Ù…ÙˆØŸ</span>
                </div>
                <div class="options-grid" id="periodOptions">
                    <!-- ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„ -->
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    
                </div>
            </div>

            <!-- Ø³Ø¤Ø§Ù„ 6: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
            <div class="question-card" data-question="6">
                <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
                <div style="text-align: center; margin-bottom: 35px;">
                    <div style="font-size: 3.5em; margin-bottom: 15px;">ğŸ‰</div>
                    <h3 style="color: var(--primary-green); font-size: 1.6em; margin-bottom: 12px; font-weight: 600;">Ù†ØªÙŠØ¬ØªÙƒ Ø¬Ø§Ù‡Ø²Ø©!</h3>
                    <p style="font-size: 1em; color: var(--text-light); line-height: 1.6;">Ù‚Ø¨Ù„ Ø§Ù„ØªÙ…ØªØ¹ Ø¨Ù‡Ø§ØŒ Ø§Ø¹Ø·ÙŠÙ†Ø§ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø¨Ø§Ø´ Ù†Ø®Ø¯Ù…ÙˆÙƒ Ø£Ø­Ø³Ù†</p>
                </div>
                
                <!-- Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ -->
                <div style="max-width: 550px; margin: 0 auto;">
                    <!-- Ø§Ù„Ø§Ø³Ù… -->
                    <div style="margin-bottom: 22px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600; color: var(--text-dark); font-size: 0.95em; text-align: right;">
                            <i class="fas fa-user" style="margin-left: 5px;"></i> Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
                        </label>
                        <input type="text" id="userName" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ù„ÙŠ" 
                            style="width: 100%; padding: 14px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1em; background: #f8f9fa; transition: all 0.3s; font-family: 'Tajawal', sans-serif;"
                            onfocus="this.style.background='white'; this.style.borderColor='var(--primary-green)'"
                            onblur="this.style.background='#f8f9fa'; this.style.borderColor='#e0e0e0'">
                    </div>
                    
                    <!-- Ø§Ù„Ù‡Ø§ØªÙ -->
                    <div style="margin-bottom: 22px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600; color: var(--text-dark); font-size: 0.95em; text-align: right;">
                            <i class="fas fa-phone" style="margin-left: 5px;"></i> Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
                        </label>
                        <input type="tel" id="userPhone" placeholder="Ù…Ø«Ø§Ù„: 20123456" 
                            style="width: 100%; padding: 14px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1em; background: #f8f9fa; transition: all 0.3s; font-family: 'Tajawal', sans-serif;"
                            onfocus="this.style.background='white'; this.style.borderColor='var(--primary-green)'"
                            onblur="this.style.background='#f8f9fa'; this.style.borderColor='#e0e0e0'">
                    </div>
                    
                    <!-- Ø§Ù„Ù…Ù†Ø·Ù‚Ø© -->
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600; color: var(--text-dark); font-size: 0.95em; text-align: right;">
                            <i class="fas fa-map-marker-alt" style="margin-left: 5px;"></i> Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
                        </label>
                        <select id="userRegion" 
                            style="width: 100%; padding: 14px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1em; background: #f8f9fa; font-family: 'Tajawal', sans-serif; cursor: pointer; transition: all 0.3s;"
                            onfocus="this.style.background='white'; this.style.borderColor='var(--primary-green)'"
                            onblur="this.style.background='#f8f9fa'; this.style.borderColor='#e0e0e0'">
                            <option value="">Ø§Ø®ØªØ§Ø± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ù…ØªØ§Ø¹Ùƒ...</option>
                            <option value="tunis">ØªÙˆÙ†Ø³</option>
                            <option value="ariana">Ø£Ø±ÙŠØ§Ù†Ø©</option>
                            <option value="ben-arous">Ø¨Ù† Ø¹Ø±ÙˆØ³</option>
                            <option value="manouba">Ù…Ù†ÙˆØ¨Ø©</option>
                            <option value="nabeul">Ù†Ø§Ø¨Ù„</option>
                            <option value="zaghouan">Ø²ØºÙˆØ§Ù†</option>
                            <option value="bizerte">Ø¨Ù†Ø²Ø±Øª</option>
                            <option value="beja">Ø¨Ø§Ø¬Ø©</option>
                            <option value="jendouba">Ø¬Ù†Ø¯ÙˆØ¨Ø©</option>
                            <option value="kef">Ø§Ù„ÙƒØ§Ù</option>
                            <option value="siliana">Ø³Ù„ÙŠØ§Ù†Ø©</option>
                            <option value="kairouan">Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù†</option>
                            <option value="kasserine">Ø§Ù„Ù‚ØµØ±ÙŠÙ†</option>
                            <option value="sidi-bouzid">Ø³ÙŠØ¯ÙŠ Ø¨ÙˆØ²ÙŠØ¯</option>
                            <option value="sousse">Ø³ÙˆØ³Ø©</option>
                            <option value="monastir">Ø§Ù„Ù…Ù†Ø³ØªÙŠØ±</option>
                            <option value="mahdia">Ø§Ù„Ù…Ù‡Ø¯ÙŠØ©</option>
                            <option value="sfax">ØµÙØ§Ù‚Ø³</option>
                            <option value="gafsa">Ù‚ÙØµØ©</option>
                            <option value="tozeur">ØªÙˆØ²Ø±</option>
                            <option value="kebili">Ù‚Ø¨Ù„ÙŠ</option>
                            <option value="gabes">Ù‚Ø§Ø¨Ø³</option>
                            <option value="medenine">Ù…Ø¯Ù†ÙŠÙ†</option>
                            <option value="tataouine">ØªØ·Ø§ÙˆÙŠÙ†</option>
                        </select>
                    </div>
                    
                    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© -->
                    <div style="background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); padding: 14px 18px; border-radius: 10px; margin-bottom: 25px; border-right: 4px solid var(--primary-green);">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <i class="fas fa-lock" style="color: var(--primary-green); margin-top: 2px; font-size: 1.1em;"></i>
                            <p style="color: #155724; font-size: 0.9em; line-height: 1.6; margin: 0;">
                                Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø¢Ù…Ù†Ø© ÙˆÙ…Ø­Ù…ÙŠØ© - Ù†Ø³ØªØ®Ø¯Ù…ÙˆÙ‡Ø§ ÙÙ‚Ø· Ø¨Ø§Ø´ Ù†Ø­Ø³Ù‘Ù†Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø© Ù…ØªØ§Ø¹Ù†Ø§
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
                <div class="nav-buttons" style="margin-top: 30px;">
                    <button type="button" class="btn btn-prev" onclick="prevQuestion()" style="max-width: 150px;">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button type="button" class="btn btn-next" onclick="showResults()" style="padding: 16px 40px; font-size: 1.05em; box-shadow: 0 4px 12px rgba(45, 134, 89, 0.25);">
                        <i class="fas fa-check-circle" style="margin-left: 8px;"></i>
                        Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù„ÙˆÙ„ ØªÙˆÙ‘Ø§
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Modal Ù„Ù„Ø­Ù„ÙˆÙ„ -->
    <div class="modal" id="resultsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">Ã—</button>
            <div class="modal-header">
                <h2>ğŸ‰ Ø­Ù„ÙˆÙ„Ùƒ Ø¬Ø§Ù‡Ø²Ø©!</h2>
                <p style="color: var(--text-light);">Ø¥Ù„ÙŠÙƒ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù…Ø­ØµÙˆÙ„Ùƒ</p>
            </div>
            <div id="resultsContent">
                <!-- ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-next" onclick="closeModal()" style="max-width: 300px;">
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // Firebase config
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyC-z9igQOo7PbKiTzhi2fIRrHHuUXhN6AU",
            authDomain: "fla7in.firebaseapp.com",
            projectId: "fla7in",
            storageBucket: "fla7in.firebasestorage.app",
            messagingSenderId: "463607450723",
            appId: "1:463607450723:web:04d95f04873d15634bfc56",
            measurementId: "G-WXN72JJ5DP"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.db = db;

        // State
        let formData = {
            crop: '',
            area: '',
            water: '',
            soil: '',
            period: '',
            name: '',
            phone: ''
        };

        let currentQuestion = 1;
        const totalQuestions = 6;

        const treeCrops = ['olive', 'almond', 'grape', 'citrus'];
        const firebaseCrops = ['olive', 'almond', 'grains', 'fennel', 'grape', 'citrus'];

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateProgress();
        });

        function setupEventListeners() {
            // Crop selection
            document.querySelectorAll('[data-crop]').forEach(card => {
                card.addEventListener('click', function() {
                    selectOption(this, 'crop', this.dataset.crop);
                    setTimeout(() => nextQuestion(), 500);
                });
            });

            // Area selection
            document.querySelectorAll('[data-area]').forEach(card => {
                card.addEventListener('click', function() {
                    selectOption(this, 'area', this.dataset.area);
                    setTimeout(() => nextQuestion(), 500);
                });
            });

            // Water selection
            document.querySelectorAll('[data-water]').forEach(card => {
                card.addEventListener('click', function() {
                    selectOption(this, 'water', this.dataset.water);
                    setTimeout(() => nextQuestion(), 500);
                });
            });

            // Soil selection
            document.querySelectorAll('[data-soil]').forEach(card => {
                card.addEventListener('click', function() {
                    selectOption(this, 'soil', this.dataset.soil);
                    setTimeout(() => nextQuestion(), 500);
                    // Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ±Ø¨Ø©ØŒ Ù†Ø­Ø¶Ù‘Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø®Ø§Ù…Ø³
                    preparePeriodQuestion();
                });
            });
        }

        function selectOption(element, field, value) {
            console.log('Selected:', field, value); // Ù„Ù„ØªØ´Ø®ÙŠØµ
            
            // Remove selected from siblings
            element.parentElement.querySelectorAll('.option-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            // Add selected to this
            element.classList.add('selected');
            
            console.log('Element classes:', element.className); // Ù„Ù„ØªØ´Ø®ÙŠØµ
            
            // Save value
            formData[field] = value;
            
            // Enable next button
            const currentCard = document.querySelector('.question-card.active');
            const nextBtn = currentCard.querySelector('.btn-next');
            if (nextBtn) {
                nextBtn.disabled = false;
            }
            
            // Scroll to show the buttons (smooth scroll)
            setTimeout(() => {
                const navButtons = currentCard.querySelector('.nav-buttons');
                if (navButtons) {
                    navButtons.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 100);
        }

        function preparePeriodQuestion() {
            const isTree = treeCrops.includes(formData.crop);
            const optionsContainer = document.getElementById('periodOptions');
            
            let options = '';
            
            if (isTree) {
                // Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø´Ø¬Ø§Ø±
                options = `
                    <div class="option-card" data-period="dormancy">
                        <span class="option-icon">ğŸŒ™</span>
                        <div class="option-label">ÙØªØ±Ø© Ø§Ù„Ø³Ø¨Ø§Øª</div>
                    </div>
                    <div class="option-card" data-period="flowering">
                        <span class="option-icon">ğŸŒ¸</span>
                        <div class="option-label">ÙØªØ±Ø© Ø§Ù„ØªØ²Ù‡ÙŠØ±</div>
                    </div>
                    <div class="option-card" data-period="fruit-set">
                        <span class="option-icon">ğŸŒ¼</span>
                        <div class="option-label">ÙØªØ±Ø© Ø§Ù„Ø¹Ù‚Ø¯</div>
                    </div>
                    <div class="option-card" data-period="ripening">
                        <span class="option-icon">ğŸ‡</span>
                        <div class="option-label">Ù†Ø¶Ø¬ Ø§Ù„Ø«Ù…Ø§Ø±</div>
                    </div>
                `;
            } else {
                // Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø®Ø¶Ø±ÙˆØ§Øª
                options = `
                    <div class="option-card" data-period="short">
                        <span class="option-icon">ğŸŒ±</span>
                        <div class="option-label">15-45 ÙŠÙˆÙ…</div>
                    </div>
                    <div class="option-card" data-period="medium">
                        <span class="option-icon">ğŸŒ¿</span>
                        <div class="option-label">45-60 ÙŠÙˆÙ…</div>
                    </div>
                    <div class="option-card" data-period="long">
                        <span class="option-icon">ğŸŒ¾</span>
                        <div class="option-label">60-90 ÙŠÙˆÙ…</div>
                    </div>
                    <div class="option-card" data-period="harvest">
                        <span class="option-icon">ğŸ…</span>
                        <div class="option-label">90+ ÙŠÙˆÙ… (Ù‚Ø¨Ù„ Ø§Ù„Ø¬Ù†ÙŠ)</div>
                    </div>
                `;
            }
            
            optionsContainer.innerHTML = options;
            
            // Add event listeners
            optionsContainer.querySelectorAll('[data-period]').forEach(card => {
                card.addEventListener('click', function() {
                    selectOption(this, 'period', this.dataset.period);
                    setTimeout(() => nextQuestion(), 500);
                });
            });
        }

        window.nextQuestion = function() {
            if (currentQuestion < totalQuestions) {
                // Hide current
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('active');
                // Show next
                currentQuestion++;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                // Update progress
                updateProgress();
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        window.prevQuestion = function() {
            if (currentQuestion > 1) {
                // Hide current
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('active');
                // Show previous
                currentQuestion--;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                // Update progress
                updateProgress();
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Ø³Ø¤Ø§Ù„ ${currentQuestion} Ù…Ù† ${totalQuestions}`;
        }

        window.showResults = async function() {
            // Get user data
            formData.name = document.getElementById('userName').value;
            formData.phone = document.getElementById('userPhone').value;

            // Show loading
            const modal = document.getElementById('resultsModal');
            const content = document.getElementById('resultsContent');
            content.innerHTML = '<div style="text-align: center; padding: 40px;"><i class="fas fa-spinner fa-spin" style="font-size: 3em; color: var(--primary-green);"></i><p style="margin-top: 20px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø­Ù„ÙˆÙ„Ùƒ...</p></div>';
            modal.classList.add('show');

            // Get solutions from Firebase
            try {
                const useFirebase = firebaseCrops.includes(formData.crop);
                const isTree = treeCrops.includes(formData.crop);
                
                let solutions = '';
                
                if (useFirebase) {
                    solutions = await getSolutionsFromFirebase(formData.crop, formData.period, isTree);
                } else {
                    solutions = '<div style="padding: 20px; background: #fff3cd; border-radius: 10px; text-align: center;">Ø§Ù„Ø­Ù„ÙˆÙ„ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØµÙˆÙ„</div>';
                }

                // Display results
                content.innerHTML = `
                    <div style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                        <h3 style="color: var(--primary-green); margin-bottom: 15px;">
                            ${getCropName(formData.crop)} - ${getPeriodName(formData.period, isTree)}
                        </h3>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <strong>ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø²Ø±Ø¹Ø©:</strong> Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${formData.area} | Ø§Ù„Ø±ÙŠ: ${formData.water} | Ø§Ù„ØªØ±Ø¨Ø©: ${formData.soil}
                        </div>
                    </div>
                    ${solutions}
                    <div class="pack-section">
                        <h3 style="color: #1565c0; margin-bottom: 20px;">ğŸ“¦ Pack Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§</h3>
                        <p>Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                    </div>
                `;
            } catch (error) {
                console.error('Error:', error);
                content.innerHTML = '<div style="padding: 20px; background: #f8d7da; border-radius: 10px; text-align: center; color: #721c24;">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø­Ù„ÙˆÙ„</div>';
            }
        }

        async function getSolutionsFromFirebase(crop, period, isTree) {
            const fieldName = isTree ? 'treeStage' : 'period';
            
            const snapshot = await getDocs(
                query(
                    collection(db, 'solutions'),
                    where('crop', '==', crop),
                    where(fieldName, '==', period),
                    where('active', '==', true)
                )
            );

            if (snapshot.empty) {
                return '<div style="padding: 20px; background: #fff3cd; border-radius: 10px; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ù„ÙˆÙ„ Ù…Ø­Ø¯Ø¯Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
            }

            let html = '';
            let productIndex = 1;
            
            snapshot.forEach(doc => {
                const solution = doc.data();
                
                if (solution.products && solution.products.length > 0) {
                    solution.products.forEach(product => {
                        html += `
                            <div class="solution-box">
                                <div style="display: flex; align-items: start; gap: 15px;">
                                    <span style="font-size: 2em;">${product.icon || 'ğŸŒ±'}</span>
                                    <div style="flex: 1;">
                                        <h4>${productIndex}. ${product.name}</h4>
                                        <div style="background: var(--warm-beige); padding: 10px; border-radius: 8px; margin: 10px 0;">
                                            <strong>ğŸ“ Ø§Ù„Ø¬Ø±Ø¹Ø©:</strong> ${product.dosage || product.dose}
                                        </div>
                                        ${product.timing ? `
                                            <div style="background: #e8f5e9; padding: 10px; border-radius: 8px; margin: 10px 0;">
                                                <strong>â° Ø§Ù„ØªÙˆÙ‚ÙŠØª:</strong> ${product.timing}
                                            </div>
                                        ` : ''}
                                        <div style="background: #e3f2fd; padding: 10px; border-radius: 8px;">
                                            <strong>ğŸ’¡ Ø¹Ù„Ø§Ø´ØŸ</strong> ${product.purpose || product.reason}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        productIndex++;
                    });
                }
            });

            return html;
        }

        function getCropName(crop) {
            const names = {
                'tomato': 'Ø§Ù„Ø·Ù…Ø§Ø·Ù…',
                'pepper': 'Ø§Ù„ÙÙ„ÙÙ„',
                'grape': 'Ø§Ù„Ø¹Ù†Ø¨',
                'fennel': 'Ø§Ù„Ø¨Ø³Ø¨Ø§Ø³',
                'potato': 'Ø§Ù„Ø¨Ø·Ø§Ø·Ø§',
                'watermelon': 'Ø§Ù„Ø¨Ø·ÙŠØ®',
                'grains': 'Ø§Ù„Ø­Ø¨ÙˆØ¨',
                'olive': 'Ø§Ù„Ø²ÙŠØªÙˆÙ†',
                'strawberry': 'Ø§Ù„ÙØ±Ø§ÙˆÙ„Ø©',
                'melon': 'Ø§Ù„Ø¯Ù„Ø§Ø¹',
                'almond': 'Ø§Ù„Ù„ÙˆØ²',
                'citrus': 'Ø§Ù„Ù‚ÙˆØ§Ø±Øµ'
            };
            return names[crop] || crop;
        }

        function getPeriodName(period, isTree) {
            if (isTree) {
                const names = {
                    'dormancy': 'ÙØªØ±Ø© Ø§Ù„Ø³Ø¨Ø§Øª',
                    'flowering': 'ÙØªØ±Ø© Ø§Ù„ØªØ²Ù‡ÙŠØ±',
                    'fruit-set': 'ÙØªØ±Ø© Ø§Ù„Ø¹Ù‚Ø¯',
                    'ripening': 'Ù†Ø¶Ø¬ Ø§Ù„Ø«Ù…Ø§Ø±'
                };
                return names[period] || period;
            } else {
                const names = {
                    'short': 'Ù…Ù† 15 Ø¥Ù„Ù‰ 45 ÙŠÙˆÙ…',
                    'medium': 'Ù…Ù† 45 Ø¥Ù„Ù‰ 60 ÙŠÙˆÙ…',
                    'long': 'Ù…Ù† 60 Ø¥Ù„Ù‰ 90 ÙŠÙˆÙ…',
                    'harvest': 'Ù…Ù† 90 ÙŠÙˆÙ… Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ù†ÙŠ'
                };
                return names[period] || period;
            }
        }

        window.closeModal = function() {
            document.getElementById('resultsModal').classList.remove('show');
        }

        // Close modal when clicking outside
        document.getElementById('resultsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
